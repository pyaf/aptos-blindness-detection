11:07:50 loading pretrained, weights/318_senet154_f1_ord/model.pth ...
11:08:29 loading pretrained, weights/318_senet154_f1_ord/model.pth ...
11:08:32 Starting epoch: 0 | phase: train | 11:08:32
11:09:51 QWK: 0.8459 | ACC: 0.7496 | TPR: 0.5146 | PPV: 0.5662 | F1: 0.5217
11:09:51 Class TPR: {0: 0.9396, 1: 0.1926, 2: 0.7853, 3: 0.3409, 4: 0.3146}
11:09:51 Class PPV: {0: 0.9351, 1: 0.2989, 2: 0.6387, 3: 0.2679, 4: 0.6907}
11:09:51 Class F1: {0: 0.9373, 1: 0.2342, 2: 0.7044, 3: 0.3, 4: 0.4323}
11:09:51 lr: 5e-06
11:09:52 Starting epoch: 0 | phase: val | 11:09:52
11:10:21 QWK: 0.8842 | ACC: 0.8115 | TPR: 0.6183 | PPV: 0.7215 | F1: 0.6279
11:10:21 Class TPR: {0: 0.9775, 1: 0.25, 2: 0.8641, 3: 0.6667, 4: 0.3333}
11:10:21 Class PPV: {0: 0.9457, 1: 0.6071, 2: 0.6737, 3: 0.5238, 4: 0.8571}
11:10:21 Class F1: {0: 0.9613, 1: 0.3542, 2: 0.7571, 3: 0.5867, 4: 0.48}
11:10:21 lr: 5e-06
11:10:30 ******** New optimal found, saving state ********
11:10:45 Total time taken so far: 02:13
11:10:45 Starting epoch: 1 | phase: train | 11:10:45
11:11:59 QWK: 0.8648 | ACC: 0.7875 | TPR: 0.5446 | PPV: 0.6213 | F1: 0.5638
11:11:59 Class TPR: {0: 0.9705, 1: 0.2444, 2: 0.8397, 3: 0.2879, 4: 0.3803}
11:11:59 Class PPV: {0: 0.9453, 1: 0.4583, 2: 0.6561, 3: 0.3363, 4: 0.7105}
11:11:59 Class F1: {0: 0.9578, 1: 0.3188, 2: 0.7366, 3: 0.3102, 4: 0.4954}
11:11:59 lr: 5e-06
11:12:07 Starting epoch: 1 | phase: val | 11:12:07
11:12:15 QWK: 0.8831 | ACC: 0.8158 | TPR: 0.5748 | PPV: 0.7217 | F1: 0.6054
11:12:15 Class TPR: {0: 0.9831, 1: 0.3235, 2: 0.9076, 3: 0.3636, 4: 0.2963}
11:12:15 Class PPV: {0: 0.9511, 1: 0.6471, 2: 0.668, 3: 0.5, 4: 0.8421}
11:12:15 Class F1: {0: 0.9669, 1: 0.4314, 2: 0.7696, 3: 0.4211, 4: 0.4384}
11:12:15 lr: 5e-06
11:12:24 ******** New optimal found, saving state ********
11:12:34 Total time taken so far: 04:02
11:12:34 Starting epoch: 2 | phase: train | 11:12:34
11:13:46 QWK: 0.8769 | ACC: 0.8001 | TPR: 0.5588 | PPV: 0.6445 | F1: 0.5809
11:13:46 Class TPR: {0: 0.9754, 1: 0.3037, 2: 0.8573, 3: 0.2727, 4: 0.385}
11:13:46 Class PPV: {0: 0.9626, 1: 0.5093, 2: 0.6628, 3: 0.3214, 4: 0.7664}
11:13:46 Class F1: {0: 0.969, 1: 0.3805, 2: 0.7476, 3: 0.2951, 4: 0.5125}
11:13:46 lr: 5e-06
11:13:55 Starting epoch: 2 | phase: val | 11:13:55
11:14:04 QWK: 0.8947 | ACC: 0.8173 | TPR: 0.5953 | PPV: 0.7130 | F1: 0.6188
11:14:04 Class TPR: {0: 0.9803, 1: 0.3529, 2: 0.8859, 3: 0.4242, 4: 0.3333}
11:14:04 Class PPV: {0: 0.9562, 1: 0.6667, 2: 0.6849, 3: 0.4, 4: 0.8571}
11:14:04 Class F1: {0: 0.9681, 1: 0.4615, 2: 0.7725, 3: 0.4118, 4: 0.48}
11:14:04 lr: 5e-06
11:14:18 ******** New optimal found, saving state ********
11:14:37 Total time taken so far: 06:04
11:14:37 Starting epoch: 3 | phase: train | 11:14:37
11:15:49 QWK: 0.8746 | ACC: 0.7925 | TPR: 0.5483 | PPV: 0.6291 | F1: 0.5698
11:15:49 Class TPR: {0: 0.9726, 1: 0.3148, 2: 0.837, 3: 0.2273, 4: 0.3897}
11:15:49 Class PPV: {0: 0.9565, 1: 0.467, 2: 0.6638, 3: 0.2679, 4: 0.7905}
11:15:49 Class F1: {0: 0.9645, 1: 0.3761, 2: 0.7404, 3: 0.2459, 4: 0.522}
11:15:49 lr: 5e-06
11:16:04 Starting epoch: 3 | phase: val | 11:16:04
11:16:12 QWK: 0.8981 | ACC: 0.8259 | TPR: 0.6121 | PPV: 0.7208 | F1: 0.6413
11:16:12 Class TPR: {0: 0.9775, 1: 0.3676, 2: 0.9022, 3: 0.4242, 4: 0.3889}
11:16:12 Class PPV: {0: 0.964, 1: 0.625, 2: 0.6888, 3: 0.5185, 4: 0.8077}
11:16:12 Class F1: {0: 0.9707, 1: 0.463, 2: 0.7812, 3: 0.4667, 4: 0.525}
11:16:12 lr: 5e-06
11:16:26 ******** New optimal found, saving state ********
11:16:43 Total time taken so far: 08:10
11:16:43 Starting epoch: 4 | phase: train | 11:16:43
11:17:24 Resuming training, loading /media/ags/DATA/CODE/kaggle/aptos2019-blindness-detection/weights/318_senet154_f1_pord/ckpt.pth ...
11:17:27 Starting epoch: 4 | phase: train | 11:17:27
11:18:45 QWK: 0.8841 | ACC: 0.8066 | TPR: 0.5784 | PPV: 0.6554 | F1: 0.5993
11:18:45 Class TPR: {0: 0.9775, 1: 0.3333, 2: 0.8533, 3: 0.3333, 4: 0.3944}
11:18:45 Class PPV: {0: 0.9647, 1: 0.5294, 2: 0.6782, 3: 0.3548, 4: 0.75}
11:18:45 Class F1: {0: 0.9711, 1: 0.4091, 2: 0.7557, 3: 0.3438, 4: 0.5169}
11:18:45 lr: 5e-06
11:18:55 Starting epoch: 4 | phase: val | 11:18:55
11:19:05 QWK: 0.8998 | ACC: 0.8216 | TPR: 0.6206 | PPV: 0.6964 | F1: 0.6398
11:19:05 Class TPR: {0: 0.9775, 1: 0.3824, 2: 0.8696, 3: 0.4848, 4: 0.3889}
11:19:05 Class PPV: {0: 0.9613, 1: 0.5778, 2: 0.708, 3: 0.4571, 4: 0.7778}
11:19:05 Class F1: {0: 0.9694, 1: 0.4602, 2: 0.7805, 3: 0.4706, 4: 0.5185}
11:19:05 lr: 5e-06
11:19:16 ******** New optimal found, saving state ********
11:19:32 Total time taken so far: 02:05
11:19:32 Starting epoch: 5 | phase: train | 11:19:32
11:20:45 QWK: 0.8936 | ACC: 0.8123 | TPR: 0.5950 | PPV: 0.6679 | F1: 0.6170
11:20:45 Class TPR: {0: 0.9691, 1: 0.4333, 2: 0.8492, 3: 0.2727, 4: 0.4507}
11:20:45 Class PPV: {0: 0.9753, 1: 0.5342, 2: 0.6876, 3: 0.3077, 4: 0.8348}
11:20:45 Class F1: {0: 0.9722, 1: 0.4785, 2: 0.7599, 3: 0.2892, 4: 0.5854}
11:20:45 lr: 5e-06
11:20:54 Starting epoch: 5 | phase: val | 11:20:54
11:21:03 QWK: 0.9051 | ACC: 0.8302 | TPR: 0.6524 | PPV: 0.7125 | F1: 0.6718
11:21:03 Class TPR: {0: 0.9747, 1: 0.4559, 2: 0.8533, 3: 0.5152, 4: 0.463}
11:21:03 Class PPV: {0: 0.9747, 1: 0.6078, 2: 0.7072, 3: 0.5152, 4: 0.7576}
11:21:03 Class F1: {0: 0.9747, 1: 0.521, 2: 0.7734, 3: 0.5152, 4: 0.5747}
11:21:03 lr: 5e-06
11:21:13 ******** New optimal found, saving state ********
11:21:25 Total time taken so far: 03:58
11:21:25 Starting epoch: 6 | phase: train | 11:21:25
11:22:38 QWK: 0.8937 | ACC: 0.8217 | TPR: 0.6088 | PPV: 0.6815 | F1: 0.6322
11:22:38 Class TPR: {0: 0.9775, 1: 0.4037, 2: 0.8628, 3: 0.3258, 4: 0.4742}
11:22:38 Class PPV: {0: 0.9721, 1: 0.5989, 2: 0.6947, 3: 0.3707, 4: 0.771}
11:22:38 Class F1: {0: 0.9748, 1: 0.4823, 2: 0.7697, 3: 0.3468, 4: 0.5872}
11:22:38 lr: 5e-06
11:22:47 Starting epoch: 6 | phase: val | 11:22:47
11:22:56 QWK: 0.8968 | ACC: 0.8273 | TPR: 0.6264 | PPV: 0.7116 | F1: 0.6528
11:22:56 Class TPR: {0: 0.9775, 1: 0.4706, 2: 0.8641, 3: 0.3939, 4: 0.4259}
11:22:56 Class PPV: {0: 0.9667, 1: 0.5818, 2: 0.7067, 3: 0.4815, 4: 0.8214}
11:22:56 Class F1: {0: 0.9721, 1: 0.5203, 2: 0.7775, 3: 0.4333, 4: 0.561}
11:22:56 lr: 5e-06
11:23:06 Total time taken so far: 05:38
11:23:06 Starting epoch: 7 | phase: train | 11:23:06
11:24:18 QWK: 0.8939 | ACC: 0.8127 | TPR: 0.5974 | PPV: 0.6645 | F1: 0.6194
11:24:18 Class TPR: {0: 0.9775, 1: 0.4074, 2: 0.8342, 3: 0.303, 4: 0.4648}
11:24:18 Class PPV: {0: 0.9707, 1: 0.5189, 2: 0.6899, 3: 0.3509, 4: 0.792}
11:24:18 Class F1: {0: 0.9741, 1: 0.4564, 2: 0.7552, 3: 0.3252, 4: 0.5858}
11:24:18 lr: 5e-06
11:24:30 Starting epoch: 7 | phase: val | 11:24:30
11:24:39 QWK: 0.8976 | ACC: 0.8259 | TPR: 0.6345 | PPV: 0.6952 | F1: 0.6569
11:24:39 Class TPR: {0: 0.9803, 1: 0.4853, 2: 0.8315, 3: 0.3939, 4: 0.4815}
11:24:39 Class PPV: {0: 0.9614, 1: 0.5893, 2: 0.7183, 3: 0.4643, 4: 0.7429}
11:24:39 Class F1: {0: 0.9708, 1: 0.5323, 2: 0.7708, 3: 0.4262, 4: 0.5843}
11:24:39 lr: 5e-06
11:24:51 Total time taken so far: 07:24
11:24:51 Starting epoch: 8 | phase: train | 11:24:51
11:26:04 QWK: 0.9070 | ACC: 0.8274 | TPR: 0.6111 | PPV: 0.6802 | F1: 0.6338
11:26:04 Class TPR: {0: 0.9818, 1: 0.4519, 2: 0.8655, 3: 0.2727, 4: 0.4836}
11:26:04 Class PPV: {0: 0.9756, 1: 0.6289, 2: 0.7101, 3: 0.3, 4: 0.7863}
11:26:04 Class F1: {0: 0.9787, 1: 0.5259, 2: 0.7802, 3: 0.2857, 4: 0.5988}
11:26:04 lr: 5e-06
11:26:13 Starting epoch: 8 | phase: val | 11:26:13
11:26:22 QWK: 0.9010 | ACC: 0.8302 | TPR: 0.6438 | PPV: 0.7131 | F1: 0.6645
11:26:22 Class TPR: {0: 0.9691, 1: 0.5, 2: 0.8696, 3: 0.4545, 4: 0.4259}
11:26:22 Class PPV: {0: 0.9773, 1: 0.6182, 2: 0.708, 3: 0.4688, 4: 0.7931}
11:26:22 Class F1: {0: 0.9732, 1: 0.5528, 2: 0.7805, 3: 0.4615, 4: 0.5542}
11:26:22 lr: 5e-06
11:26:31 ******** New optimal found, saving state ********
11:26:47 Total time taken so far: 09:19
11:26:47 Starting epoch: 9 | phase: train | 11:26:47
11:27:59 QWK: 0.9094 | ACC: 0.8325 | TPR: 0.6348 | PPV: 0.6919 | F1: 0.6558
11:27:59 Class TPR: {0: 0.9811, 1: 0.4519, 2: 0.8573, 3: 0.3485, 4: 0.5352}
11:27:59 Class PPV: {0: 0.9763, 1: 0.5837, 2: 0.722, 3: 0.4071, 4: 0.7703}
11:27:59 Class F1: {0: 0.9786, 1: 0.5094, 2: 0.7839, 3: 0.3755, 4: 0.6316}
11:27:59 lr: 5e-06
11:28:10 Starting epoch: 9 | phase: val | 11:28:10
11:28:19 QWK: 0.8995 | ACC: 0.8273 | TPR: 0.6467 | PPV: 0.7036 | F1: 0.6660
11:28:19 Class TPR: {0: 0.9635, 1: 0.5294, 2: 0.8533, 3: 0.4242, 4: 0.463}
11:28:19 Class PPV: {0: 0.9772, 1: 0.5902, 2: 0.7104, 3: 0.4828, 4: 0.7576}
11:28:19 Class F1: {0: 0.9703, 1: 0.5581, 2: 0.7753, 3: 0.4516, 4: 0.5747}
11:28:19 lr: 5e-06
11:28:28 ******** New optimal found, saving state ********
11:28:44 Total time taken so far: 11:16
11:28:44 Starting epoch: 10 | phase: train | 11:28:44
11:29:56 QWK: 0.9091 | ACC: 0.8329 | TPR: 0.6425 | PPV: 0.6986 | F1: 0.6611
11:29:56 Class TPR: {0: 0.9775, 1: 0.4778, 2: 0.856, 3: 0.3939, 4: 0.507}
11:29:56 Class PPV: {0: 0.9789, 1: 0.6056, 2: 0.7258, 3: 0.3768, 4: 0.806}
11:29:56 Class F1: {0: 0.9782, 1: 0.5342, 2: 0.7855, 3: 0.3852, 4: 0.6225}
11:29:56 lr: 5e-06
11:30:07 Starting epoch: 10 | phase: val | 11:30:06
11:30:15 QWK: 0.9012 | ACC: 0.8245 | TPR: 0.6243 | PPV: 0.6931 | F1: 0.6440
11:30:15 Class TPR: {0: 0.9691, 1: 0.5, 2: 0.8696, 3: 0.3939, 4: 0.3889}
11:30:15 Class PPV: {0: 0.9746, 1: 0.6296, 2: 0.7048, 3: 0.4062, 4: 0.75}
11:30:15 Class F1: {0: 0.9718, 1: 0.5574, 2: 0.7786, 3: 0.4, 4: 0.5122}
11:30:15 lr: 5e-06
11:30:28 Total time taken so far: 13:01
11:30:29 Starting epoch: 11 | phase: train | 11:30:29
11:31:41 QWK: 0.9066 | ACC: 0.8325 | TPR: 0.6330 | PPV: 0.6956 | F1: 0.6550
11:31:41 Class TPR: {0: 0.9789, 1: 0.4704, 2: 0.8614, 3: 0.3333, 4: 0.5211}
11:31:41 Class PPV: {0: 0.9742, 1: 0.6135, 2: 0.7221, 3: 0.3636, 4: 0.8043}
11:31:41 Class F1: {0: 0.9765, 1: 0.5325, 2: 0.7856, 3: 0.3478, 4: 0.6325}
11:31:41 lr: 5e-06
11:31:51 Starting epoch: 11 | phase: val | 11:31:51
11:32:00 QWK: 0.9047 | ACC: 0.8259 | TPR: 0.6763 | PPV: 0.6969 | F1: 0.6823
11:32:00 Class TPR: {0: 0.9551, 1: 0.5588, 2: 0.8152, 3: 0.5152, 4: 0.537}
11:32:00 Class PPV: {0: 0.9884, 1: 0.6129, 2: 0.7109, 3: 0.4474, 4: 0.725}
11:32:00 Class F1: {0: 0.9714, 1: 0.5846, 2: 0.7595, 3: 0.4789, 4: 0.617}
11:32:00 lr: 5e-06
11:32:13 Total time taken so far: 14:45
11:32:13 Starting epoch: 12 | phase: train | 11:32:13
11:33:25 QWK: 0.9083 | ACC: 0.8307 | TPR: 0.6359 | PPV: 0.6916 | F1: 0.6545
11:33:25 Class TPR: {0: 0.9768, 1: 0.4889, 2: 0.856, 3: 0.3788, 4: 0.4789}
11:33:25 Class PPV: {0: 0.9831, 1: 0.6, 2: 0.7175, 3: 0.3846, 4: 0.7727}
11:33:25 Class F1: {0: 0.9799, 1: 0.5388, 2: 0.7807, 3: 0.3817, 4: 0.5913}
11:33:25 lr: 5e-06
11:33:35 Starting epoch: 12 | phase: val | 11:33:35
11:33:43 QWK: 0.8933 | ACC: 0.8230 | TPR: 0.6383 | PPV: 0.6901 | F1: 0.6516
11:33:43 Class TPR: {0: 0.9719, 1: 0.6029, 2: 0.8152, 3: 0.3939, 4: 0.4074}
11:33:43 Class PPV: {0: 0.9719, 1: 0.5857, 2: 0.7246, 3: 0.3824, 4: 0.7857}
11:33:43 Class F1: {0: 0.9719, 1: 0.5942, 2: 0.7673, 3: 0.3881, 4: 0.5366}
11:33:43 lr: 5e-06
11:33:55 Total time taken so far: 16:27
11:33:55 Starting epoch: 13 | phase: train | 11:33:55
11:35:07 QWK: 0.9136 | ACC: 0.8419 | TPR: 0.6498 | PPV: 0.7096 | F1: 0.6712
11:35:07 Class TPR: {0: 0.9846, 1: 0.5444, 2: 0.856, 3: 0.3333, 4: 0.5305}
11:35:07 Class PPV: {0: 0.9832, 1: 0.6533, 2: 0.7292, 3: 0.3577, 4: 0.8248}
11:35:07 Class F1: {0: 0.9839, 1: 0.5939, 2: 0.7875, 3: 0.3451, 4: 0.6457}
11:35:07 lr: 5e-06
11:35:17 Starting epoch: 13 | phase: val | 11:35:17
11:35:26 QWK: 0.9095 | ACC: 0.8273 | TPR: 0.6661 | PPV: 0.6930 | F1: 0.6760
11:35:26 Class TPR: {0: 0.9663, 1: 0.5441, 2: 0.8098, 3: 0.4545, 4: 0.5556}
11:35:26 Class PPV: {0: 0.9801, 1: 0.6167, 2: 0.7198, 3: 0.4167, 4: 0.7317}
11:35:26 Class F1: {0: 0.9731, 1: 0.5781, 2: 0.7621, 3: 0.4348, 4: 0.6316}
11:35:26 lr: 5e-06
11:35:39 Total time taken so far: 18:11
11:35:39 Starting epoch: 14 | phase: train | 11:35:39
11:36:51 QWK: 0.9217 | ACC: 0.8487 | TPR: 0.6771 | PPV: 0.7204 | F1: 0.6943
11:36:51 Class TPR: {0: 0.9825, 1: 0.4926, 2: 0.8601, 3: 0.4167, 4: 0.6338}
11:36:51 Class PPV: {0: 0.9777, 1: 0.6488, 2: 0.7518, 3: 0.4435, 4: 0.7803}
11:36:51 Class F1: {0: 0.98, 1: 0.56, 2: 0.8023, 3: 0.4297, 4: 0.6995}
11:36:51 lr: 5.000000000000001e-07
11:37:02 Starting epoch: 14 | phase: val | 11:37:02
11:37:10 QWK: 0.9033 | ACC: 0.8245 | TPR: 0.6359 | PPV: 0.6978 | F1: 0.6557
11:37:10 Class TPR: {0: 0.9663, 1: 0.5441, 2: 0.8424, 3: 0.3636, 4: 0.463}
11:37:10 Class PPV: {0: 0.9773, 1: 0.6167, 2: 0.7014, 3: 0.3871, 4: 0.8065}
11:37:10 Class F1: {0: 0.9718, 1: 0.5781, 2: 0.7654, 3: 0.375, 4: 0.5882}
11:37:10 lr: 5.000000000000001e-07
11:37:20 Total time taken so far: 19:53
11:37:20 Starting epoch: 15 | phase: train | 11:37:20
11:38:33 QWK: 0.9239 | ACC: 0.8501 | TPR: 0.6677 | PPV: 0.7203 | F1: 0.6881
11:38:33 Class TPR: {0: 0.9895, 1: 0.5, 2: 0.8628, 3: 0.3712, 4: 0.615}
11:38:33 Class PPV: {0: 0.9792, 1: 0.675, 2: 0.7462, 3: 0.4118, 4: 0.7892}
11:38:33 Class F1: {0: 0.9843, 1: 0.5745, 2: 0.8003, 3: 0.3904, 4: 0.6913}
11:38:33 lr: 5.000000000000001e-07
11:38:44 Starting epoch: 15 | phase: val | 11:38:44
11:38:53 QWK: 0.9006 | ACC: 0.8302 | TPR: 0.6476 | PPV: 0.7069 | F1: 0.6681
11:38:53 Class TPR: {0: 0.9747, 1: 0.5735, 2: 0.8261, 3: 0.3636, 4: 0.5}
11:38:53 Class PPV: {0: 0.9775, 1: 0.6, 2: 0.7103, 3: 0.4286, 4: 0.8182}
11:38:53 Class F1: {0: 0.9761, 1: 0.5865, 2: 0.7638, 3: 0.3934, 4: 0.6207}
11:38:53 lr: 5.000000000000001e-07
11:39:04 Total time taken so far: 21:37
11:39:04 Starting epoch: 16 | phase: train | 11:39:04
