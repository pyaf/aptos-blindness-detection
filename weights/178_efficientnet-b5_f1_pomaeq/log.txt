14:26:36 loading pretrained, weights/178_efficientnet-b5_f1_pomaeq/ckpt10.pth ...
14:27:19 loading pretrained, weights/178_efficientnet-b5_f1_omaeq/ckpt10.pth ...
14:27:25 Starting epoch: 0 | phase: train | 14:27:25
14:30:46 base: QWK: 0.6231 | ACC: 0.4004 | TPR: 0.3541 | PPV: 0.3752
14:30:46 Class TPR: {0: 0.4642, 1: 0.3457, 2: 0.3497, 3: 0.3881, 4: 0.2227}
14:30:46 Class PPV: {0: 0.9285, 1: 0.1095, 2: 0.4016, 3: 0.1229, 4: 0.3133}
14:30:46 lr: 1e-05
14:30:46 Starting epoch: 0 | phase: val | 14:30:46
14:31:40 best: QWK: 0.7765 | ACC: 0.5532 | TPR: 0.4643 | PPV: 0.5321
14:31:40 Class TPR: {0: 0.6919, 1: 0.4265, 2: 0.4348, 3: 0.6176, 4: 0.1509}
14:31:40 Class PPV: {0: 0.9724, 1: 0.1747, 2: 0.6349, 3: 0.1511, 4: 0.7273}
14:31:40 base: QWK: 0.7660 | ACC: 0.5546 | TPR: 0.4582 | PPV: 0.4863
14:31:40 Class TPR: {0: 0.6555, 1: 0.4412, 2: 0.5163, 3: 0.4706, 4: 0.2075}
14:31:40 Class PPV: {0: 0.975, 1: 0.1667, 2: 0.6376, 3: 0.1524, 4: 0.5}
14:31:40 lr: 1e-05
14:31:42 ******** New optimal found, saving state ********
14:31:47 Total time taken so far: 04:21
14:31:47 Starting epoch: 1 | phase: train | 14:31:47
14:34:31 base: QWK: 0.7288 | ACC: 0.5377 | TPR: 0.4023 | PPV: 0.4462
14:34:31 Class TPR: {0: 0.6613, 1: 0.4089, 2: 0.5102, 3: 0.3507, 4: 0.0806}
14:34:31 Class PPV: {0: 0.9439, 1: 0.1493, 2: 0.5589, 3: 0.1429, 4: 0.4359}
14:34:31 lr: 1e-05
14:34:32 Starting epoch: 1 | phase: val | 14:34:32
14:35:25 best: QWK: 0.8007 | ACC: 0.6250 | TPR: 0.4691 | PPV: 0.4913
14:35:25 Class TPR: {0: 0.8011, 1: 0.4118, 2: 0.538, 3: 0.5, 4: 0.0943}
14:35:25 Class PPV: {0: 0.9565, 1: 0.2171, 2: 0.6, 3: 0.1828, 4: 0.5}
14:35:25 base: QWK: 0.7926 | ACC: 0.6193 | TPR: 0.4633 | PPV: 0.4673
14:35:25 Class TPR: {0: 0.7927, 1: 0.4265, 2: 0.5326, 3: 0.4706, 4: 0.0943}
14:35:25 Class PPV: {0: 0.9561, 1: 0.2148, 2: 0.6012, 3: 0.1798, 4: 0.3846}
14:35:25 lr: 1e-05
14:35:26 ******** New optimal found, saving state ********
14:35:28 Total time taken so far: 08:03
14:35:28 Starting epoch: 2 | phase: train | 14:35:28
14:37:38 base: QWK: 0.7631 | ACC: 0.6043 | TPR: 0.4546 | PPV: 0.4895
14:37:38 Class TPR: {0: 0.756, 1: 0.4461, 2: 0.5442, 3: 0.4179, 4: 0.109}
14:37:38 Class PPV: {0: 0.9523, 1: 0.1843, 2: 0.5988, 3: 0.2007, 4: 0.5111}
14:37:38 lr: 1e-05
14:37:39 Starting epoch: 2 | phase: val | 14:37:39
14:38:26 best: QWK: 0.8412 | ACC: 0.6566 | TPR: 0.4484 | PPV: 0.4873
14:38:26 Class TPR: {0: 0.8768, 1: 0.3235, 2: 0.5652, 3: 0.3824, 4: 0.0943}
14:38:26 Class PPV: {0: 0.969, 1: 0.2444, 2: 0.5876, 3: 0.1354, 4: 0.5}
14:38:26 base: QWK: 0.8262 | ACC: 0.6437 | TPR: 0.4261 | PPV: 0.4756
14:38:26 Class TPR: {0: 0.8711, 1: 0.3676, 2: 0.5326, 3: 0.2647, 4: 0.0943}
14:38:26 Class PPV: {0: 0.9688, 1: 0.2315, 2: 0.5731, 3: 0.1047, 4: 0.5}
14:38:26 lr: 1e-05
14:38:27 ******** New optimal found, saving state ********
14:38:29 Total time taken so far: 11:04
14:38:29 Starting epoch: 3 | phase: train | 14:38:29
14:40:29 base: QWK: 0.7834 | ACC: 0.6216 | TPR: 0.4589 | PPV: 0.4998
14:40:29 Class TPR: {0: 0.7756, 1: 0.4089, 2: 0.5837, 3: 0.403, 4: 0.1232}
14:40:29 Class PPV: {0: 0.9461, 1: 0.1971, 2: 0.6085, 3: 0.1818, 4: 0.5652}
14:40:29 lr: 1e-05
14:40:30 Starting epoch: 3 | phase: val | 14:40:30
14:41:06 best: QWK: 0.8557 | ACC: 0.6652 | TPR: 0.4884 | PPV: 0.5492
14:41:06 Class TPR: {0: 0.93, 1: 0.25, 2: 0.462, 3: 0.7059, 4: 0.0943}
14:41:06 Class PPV: {0: 0.9623, 1: 0.3148, 2: 0.5903, 3: 0.1644, 4: 0.7143}
14:41:06 base: QWK: 0.8217 | ACC: 0.6767 | TPR: 0.4671 | PPV: 0.5496
14:41:06 Class TPR: {0: 0.8852, 1: 0.3971, 2: 0.5978, 3: 0.3235, 4: 0.1321}
14:41:06 Class PPV: {0: 0.9605, 1: 0.2621, 2: 0.5699, 3: 0.1774, 4: 0.7778}
14:41:06 lr: 1e-05
14:41:07 ******** New optimal found, saving state ********
14:41:09 Total time taken so far: 13:44
14:41:09 Starting epoch: 4 | phase: train | 14:41:09
14:43:00 base: QWK: 0.7792 | ACC: 0.6281 | TPR: 0.4659 | PPV: 0.5190
14:43:00 Class TPR: {0: 0.7987, 1: 0.3978, 2: 0.5646, 3: 0.4925, 4: 0.0758}
14:43:00 Class PPV: {0: 0.9398, 1: 0.1993, 2: 0.6112, 3: 0.205, 4: 0.64}
14:43:00 lr: 1e-05
14:43:02 Starting epoch: 4 | phase: val | 14:43:02
14:43:24 best: QWK: 0.8471 | ACC: 0.6710 | TPR: 0.5004 | PPV: 0.5648
14:43:24 Class TPR: {0: 0.916, 1: 0.3824, 2: 0.4728, 3: 0.6176, 4: 0.1132}
14:43:24 Class PPV: {0: 0.9534, 1: 0.325, 2: 0.6304, 3: 0.1654, 4: 0.75}
14:43:24 base: QWK: 0.8216 | ACC: 0.7069 | TPR: 0.5009 | PPV: 0.5488
14:43:24 Class TPR: {0: 0.9076, 1: 0.4412, 2: 0.6413, 3: 0.3824, 4: 0.1321}
14:43:24 Class PPV: {0: 0.9586, 1: 0.2913, 2: 0.6448, 3: 0.2131, 4: 0.6364}
14:43:24 lr: 1e-05
14:43:26 Total time taken so far: 16:01
14:43:26 Starting epoch: 5 | phase: train | 14:43:26
14:45:10 base: QWK: 0.7968 | ACC: 0.6519 | TPR: 0.4765 | PPV: 0.5309
14:45:10 Class TPR: {0: 0.8177, 1: 0.3978, 2: 0.6177, 3: 0.4403, 4: 0.109}
14:45:10 Class PPV: {0: 0.9526, 1: 0.2106, 2: 0.6236, 3: 0.2107, 4: 0.6571}
14:45:10 lr: 1e-05
14:45:12 Starting epoch: 5 | phase: val | 14:45:12
14:45:37 best: QWK: 0.8543 | ACC: 0.6897 | TPR: 0.5414 | PPV: 0.5576
14:45:37 Class TPR: {0: 0.944, 1: 0.4118, 2: 0.4293, 3: 0.6765, 4: 0.2453}
14:45:37 Class PPV: {0: 0.952, 1: 0.4179, 2: 0.6529, 3: 0.1742, 4: 0.5909}
14:45:37 base: QWK: 0.8341 | ACC: 0.7155 | TPR: 0.5204 | PPV: 0.5377
14:45:37 Class TPR: {0: 0.916, 1: 0.4853, 2: 0.6359, 3: 0.4706, 4: 0.0943}
14:45:37 Class PPV: {0: 0.9618, 1: 0.33, 2: 0.6257, 3: 0.2712, 4: 0.5}
14:45:37 lr: 1e-05
14:45:39 ******** New optimal found, saving state ********
14:45:41 Total time taken so far: 18:15
14:46:00 Resuming training, loading /media/ags/DATA/CODE/kaggle/aptos2019-blindness-detection/weights/178_efficientnet-b5_f1_pomaeq/ckpt.pth ...
14:46:04 Starting epoch: 6 | phase: train | 14:46:04
14:48:43 base: QWK: 0.8266 | ACC: 0.6353 | TPR: 0.4941 | PPV: 0.5736
14:48:43 Class TPR: {0: 0.7083, 1: 0.3755, 2: 0.7483, 3: 0.4254, 4: 0.2133}
14:48:43 Class PPV: {0: 0.9912, 1: 0.1757, 2: 0.6448, 3: 0.2073, 4: 0.8491}
14:48:43 lr: 1e-05
14:48:45 Starting epoch: 6 | phase: val | 14:48:45
14:49:36 best: QWK: 0.8866 | ACC: 0.7443 | TPR: 0.5484 | PPV: 0.6096
14:49:36 Class TPR: {0: 0.8683, 1: 0.4412, 2: 0.8261, 3: 0.3235, 4: 0.283}
14:49:36 Class PPV: {0: 0.9936, 1: 0.3371, 2: 0.6909, 3: 0.193, 4: 0.8333}
14:49:36 base: QWK: 0.8804 | ACC: 0.7486 | TPR: 0.5323 | PPV: 0.6018
14:49:36 Class TPR: {0: 0.8655, 1: 0.3971, 2: 0.8804, 3: 0.2353, 4: 0.283}
14:49:36 Class PPV: {0: 0.9936, 1: 0.3253, 2: 0.675, 3: 0.1818, 4: 0.8333}
14:49:36 lr: 1e-05
14:49:37 ******** New optimal found, saving state ********
14:49:40 Total time taken so far: 03:35
14:49:40 Starting epoch: 7 | phase: train | 14:49:40
14:52:30 base: QWK: 0.8267 | ACC: 0.6317 | TPR: 0.4922 | PPV: 0.5617
14:52:30 Class TPR: {0: 0.7209, 1: 0.3606, 2: 0.7088, 3: 0.4478, 4: 0.2227}
14:52:30 Class PPV: {0: 0.9885, 1: 0.1735, 2: 0.6225, 3: 0.2135, 4: 0.8103}
14:52:30 lr: 1e-05
14:52:32 Starting epoch: 7 | phase: val | 14:52:32
14:53:17 best: QWK: 0.8917 | ACC: 0.7414 | TPR: 0.5491 | PPV: 0.5921
14:53:17 Class TPR: {0: 0.8936, 1: 0.4706, 2: 0.7391, 3: 0.2647, 4: 0.3774}
14:53:17 Class PPV: {0: 0.9907, 1: 0.3765, 2: 0.6834, 3: 0.1406, 4: 0.7692}
14:53:17 base: QWK: 0.8781 | ACC: 0.7471 | TPR: 0.5309 | PPV: 0.5930
14:53:17 Class TPR: {0: 0.8711, 1: 0.4412, 2: 0.8533, 3: 0.2059, 4: 0.283}
14:53:17 Class PPV: {0: 0.9904, 1: 0.3448, 2: 0.6653, 3: 0.175, 4: 0.7895}
14:53:17 lr: 1e-05
14:53:20 ******** New optimal found, saving state ********
14:53:22 Total time taken so far: 07:18
14:53:22 Starting epoch: 8 | phase: train | 14:53:22
14:57:39 base: QWK: 0.8320 | ACC: 0.6555 | TPR: 0.4916 | PPV: 0.5639
14:57:39 Class TPR: {0: 0.7616, 1: 0.342, 2: 0.7361, 3: 0.3955, 4: 0.2227}
14:57:39 Class PPV: {0: 0.9828, 1: 0.1811, 2: 0.6357, 3: 0.2095, 4: 0.8103}
14:57:39 lr: 1e-05
14:58:32 Starting epoch: 8 | phase: val | 14:58:32
14:59:45 best: QWK: 0.8891 | ACC: 0.7586 | TPR: 0.5825 | PPV: 0.6041
14:59:45 Class TPR: {0: 0.9132, 1: 0.5, 2: 0.7228, 3: 0.3235, 4: 0.4528}
14:59:45 Class PPV: {0: 0.9819, 1: 0.3736, 2: 0.7074, 3: 0.2075, 4: 0.75}
14:59:45 base: QWK: 0.8725 | ACC: 0.7500 | TPR: 0.5231 | PPV: 0.5984
14:59:45 Class TPR: {0: 0.8908, 1: 0.3529, 2: 0.8533, 3: 0.2353, 4: 0.283}
14:59:45 Class PPV: {0: 0.9845, 1: 0.32, 2: 0.6542, 3: 0.2, 4: 0.8333}
14:59:45 lr: 1e-05
15:00:44 Total time taken so far: 14:39
15:00:44 Starting epoch: 9 | phase: train | 15:00:44
15:05:45 base: QWK: 0.8345 | ACC: 0.6699 | TPR: 0.5059 | PPV: 0.5687
15:05:45 Class TPR: {0: 0.7763, 1: 0.4015, 2: 0.7429, 3: 0.3955, 4: 0.2133}
15:05:45 Class PPV: {0: 0.9849, 1: 0.2101, 2: 0.6462, 3: 0.2265, 4: 0.7759}
15:05:45 lr: 1e-05
15:06:35 Starting epoch: 9 | phase: val | 15:06:35
15:08:00 best: QWK: 0.8830 | ACC: 0.7313 | TPR: 0.5675 | PPV: 0.6168
15:08:00 Class TPR: {0: 0.9076, 1: 0.5, 2: 0.6467, 3: 0.5, 4: 0.283}
15:08:00 Class PPV: {0: 0.9818, 1: 0.3736, 2: 0.7, 3: 0.1954, 4: 0.8333}
15:08:00 base: QWK: 0.8737 | ACC: 0.7543 | TPR: 0.5303 | PPV: 0.6062
15:08:00 Class TPR: {0: 0.9048, 1: 0.3676, 2: 0.8315, 3: 0.2647, 4: 0.283}
15:08:00 Class PPV: {0: 0.9848, 1: 0.3425, 2: 0.6456, 3: 0.225, 4: 0.8333}
15:08:00 lr: 1e-05
15:08:48 Total time taken so far: 22:43
15:08:48 Starting epoch: 10 | phase: train | 15:08:48
15:13:49 base: QWK: 0.8393 | ACC: 0.6811 | TPR: 0.5104 | PPV: 0.5751
15:13:50 Class TPR: {0: 0.8008, 1: 0.3755, 2: 0.7456, 3: 0.4403, 4: 0.1896}
15:13:50 Class PPV: {0: 0.9803, 1: 0.2087, 2: 0.6563, 3: 0.2458, 4: 0.7843}
15:13:50 lr: 1e-05
15:14:34 Starting epoch: 10 | phase: val | 15:14:34
15:15:55 best: QWK: 0.8930 | ACC: 0.7557 | TPR: 0.5734 | PPV: 0.6214
15:15:55 Class TPR: {0: 0.9076, 1: 0.4412, 2: 0.75, 3: 0.3529, 4: 0.4151}
15:15:55 Class PPV: {0: 0.9848, 1: 0.4054, 2: 0.697, 3: 0.1739, 4: 0.8462}
15:15:55 base: QWK: 0.8827 | ACC: 0.7658 | TPR: 0.5456 | PPV: 0.6155
15:15:55 Class TPR: {0: 0.8936, 1: 0.4412, 2: 0.875, 3: 0.2353, 4: 0.283}
15:15:55 Class PPV: {0: 0.9846, 1: 0.3704, 2: 0.694, 3: 0.1951, 4: 0.8333}
15:15:55 lr: 1e-05
15:16:36 Total time taken so far: 30:32
17:39:46 Resuming training, loading /media/ags/DATA/CODE/kaggle/aptos2019-blindness-detection/weights/178_efficientnet-b5_f1_pomaeq/ckpt.pth ...
17:39:51 Starting epoch: 11 | phase: train | 17:39:51
17:42:10 base: QWK: 0.8333 | ACC: 0.6930 | TPR: 0.5010 | PPV: 0.5879
17:42:10 Class TPR: {0: 0.8247, 1: 0.4535, 2: 0.7361, 3: 0.2537, 4: 0.237}
17:42:10 Class PPV: {0: 0.9874, 1: 0.236, 2: 0.632, 3: 0.2222, 4: 0.8621}
17:42:10 lr: 1e-05
17:42:12 Starting epoch: 11 | phase: val | 17:42:12
17:43:04 best: QWK: 0.8904 | ACC: 0.7428 | TPR: 0.5455 | PPV: 0.6192
17:43:04 Class TPR: {0: 0.9412, 1: 0.3971, 2: 0.6902, 3: 0.5294, 4: 0.1698}
17:43:04 Class PPV: {0: 0.9882, 1: 0.4154, 2: 0.6828, 3: 0.1915, 4: 0.8182}
17:43:04 base: QWK: 0.8723 | ACC: 0.7629 | TPR: 0.5120 | PPV: 0.5838
17:43:04 Class TPR: {0: 0.916, 1: 0.4412, 2: 0.8587, 3: 0.1176, 4: 0.2264}
17:43:04 Class PPV: {0: 0.9879, 1: 0.3614, 2: 0.6529, 3: 0.1667, 4: 0.75}
17:43:04 lr: 1e-05
17:43:07 Total time taken so far: 03:15
17:43:07 Starting epoch: 12 | phase: train | 17:43:07
17:45:44 base: QWK: 0.8316 | ACC: 0.6919 | TPR: 0.4972 | PPV: 0.5813
17:45:44 Class TPR: {0: 0.8303, 1: 0.461, 2: 0.7252, 3: 0.2612, 4: 0.2085}
17:45:44 Class PPV: {0: 0.9793, 1: 0.2385, 2: 0.6399, 3: 0.2188, 4: 0.8302}
17:45:44 lr: 1e-05
17:45:46 Starting epoch: 12 | phase: val | 17:45:46
17:46:36 best: QWK: 0.8927 | ACC: 0.7615 | TPR: 0.5339 | PPV: 0.6095
17:46:36 Class TPR: {0: 0.93, 1: 0.4118, 2: 0.7989, 3: 0.2647, 4: 0.2642}
17:46:36 Class PPV: {0: 0.9822, 1: 0.3944, 2: 0.6774, 3: 0.1698, 4: 0.8235}
17:46:36 base: QWK: 0.8821 | ACC: 0.7716 | TPR: 0.5231 | PPV: 0.5991
17:46:36 Class TPR: {0: 0.9188, 1: 0.4559, 2: 0.8696, 3: 0.0882, 4: 0.283}
17:46:36 Class PPV: {0: 0.9909, 1: 0.3735, 2: 0.6612, 3: 0.1364, 4: 0.8333}
17:46:36 lr: 1e-05
17:46:39 Total time taken so far: 06:47
17:46:39 Starting epoch: 13 | phase: train | 17:46:39
17:49:13 base: QWK: 0.8401 | ACC: 0.7153 | TPR: 0.5286 | PPV: 0.6016
17:49:13 Class TPR: {0: 0.8513, 1: 0.4721, 2: 0.7469, 3: 0.3358, 4: 0.237}
17:49:13 Class PPV: {0: 0.9854, 1: 0.2714, 2: 0.6466, 3: 0.2711, 4: 0.8333}
17:49:13 lr: 1e-05
17:49:15 Starting epoch: 13 | phase: val | 17:49:15
17:50:06 best: QWK: 0.8978 | ACC: 0.7830 | TPR: 0.5887 | PPV: 0.6065
17:50:06 Class TPR: {0: 0.9412, 1: 0.4265, 2: 0.7663, 3: 0.2059, 4: 0.6038}
17:50:06 Class PPV: {0: 0.9767, 1: 0.4394, 2: 0.6878, 3: 0.1842, 4: 0.7442}
17:50:06 base: QWK: 0.8809 | ACC: 0.7658 | TPR: 0.5312 | PPV: 0.6065
17:50:06 Class TPR: {0: 0.9132, 1: 0.4706, 2: 0.8424, 3: 0.1471, 4: 0.283}
17:50:06 Class PPV: {0: 0.9819, 1: 0.3678, 2: 0.671, 3: 0.1786, 4: 0.8333}
17:50:06 lr: 1e-05
17:50:08 Total time taken so far: 10:16
17:50:08 Starting epoch: 14 | phase: train | 17:50:08
17:52:39 base: QWK: 0.8490 | ACC: 0.7023 | TPR: 0.5072 | PPV: 0.5821
17:52:39 Class TPR: {0: 0.8429, 1: 0.4498, 2: 0.7347, 3: 0.2761, 4: 0.2322}
17:52:39 Class PPV: {0: 0.9812, 1: 0.2648, 2: 0.6413, 3: 0.1927, 4: 0.8305}
17:52:39 lr: 1e-05
17:52:41 Starting epoch: 14 | phase: val | 17:52:41
17:53:29 best: QWK: 0.8942 | ACC: 0.7816 | TPR: 0.5574 | PPV: 0.6295
17:53:29 Class TPR: {0: 0.9216, 1: 0.4559, 2: 0.8641, 3: 0.2059, 4: 0.3396}
17:53:29 Class PPV: {0: 0.985, 1: 0.4306, 2: 0.6853, 3: 0.1892, 4: 0.8571}
17:53:29 base: QWK: 0.8792 | ACC: 0.7773 | TPR: 0.5392 | PPV: 0.6144
17:53:29 Class TPR: {0: 0.916, 1: 0.4853, 2: 0.875, 3: 0.1176, 4: 0.3019}
17:53:29 Class PPV: {0: 0.9849, 1: 0.3976, 2: 0.6736, 3: 0.1739, 4: 0.8421}
17:53:29 lr: 1e-05
17:53:31 Total time taken so far: 13:39
17:53:31 Starting epoch: 15 | phase: train | 17:53:31
17:55:59 base: QWK: 0.8429 | ACC: 0.7099 | TPR: 0.5161 | PPV: 0.5955
17:55:59 Class TPR: {0: 0.8464, 1: 0.4647, 2: 0.7469, 3: 0.2761, 4: 0.2464}
17:55:59 Class PPV: {0: 0.9773, 1: 0.2688, 2: 0.6544, 3: 0.2102, 4: 0.8667}
17:55:59 lr: 1e-05
17:56:01 Starting epoch: 15 | phase: val | 17:56:01
17:56:49 best: QWK: 0.8882 | ACC: 0.7399 | TPR: 0.5658 | PPV: 0.6088
17:56:49 Class TPR: {0: 0.944, 1: 0.5441, 2: 0.5978, 3: 0.4412, 4: 0.3019}
17:56:49 Class PPV: {0: 0.9825, 1: 0.4302, 2: 0.7006, 3: 0.1685, 4: 0.7619}
17:56:49 base: QWK: 0.8723 | ACC: 0.7701 | TPR: 0.5180 | PPV: 0.5804
17:56:49 Class TPR: {0: 0.93, 1: 0.4412, 2: 0.8478, 3: 0.0882, 4: 0.283}
17:56:49 Class PPV: {0: 0.9822, 1: 0.3947, 2: 0.6638, 3: 0.1111, 4: 0.75}
17:56:49 lr: 1e-05
17:56:51 Total time taken so far: 16:59
